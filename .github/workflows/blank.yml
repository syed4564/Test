name: Remote Desktop Colab 1

on:
  workflow_dispatch:
    inputs:
      remote_code:
        description: 'Enter Chrome Remote Desktop Code'
        required: true
        type: string

jobs:
  build:
    name: Start RDP with Software, VPN, Audio, and Loop
    runs-on: windows-latest

    steps:
      # =============================
      # Chrome Remote Desktop Install
      # =============================
      - name: Install Chrome Remote Desktop Host
        run: |
          $msiUrl = "https://dl.google.com/edgedl/chrome-remote-desktop/chromeremotedesktophost.msi"
          $msiPath = "$env:TEMP\chromeremotedesktophost.msi"
          Invoke-WebRequest -Uri $msiUrl -OutFile $msiPath
          Start-Process msiexec.exe -ArgumentList "/i `"$msiPath`" /qn" -Wait
          Write-Output "✅ Chrome Remote Desktop installed."

      - name: Start Chrome Remote Desktop Session
        run: |
          $code = "${{ github.event.inputs.remote_code }}"
          $redirect = "https://remotedesktop.google.com/_/oauthredirect"
          $hostName = $env:COMPUTERNAME
          $exePath = "${env:ProgramFiles(x86)}\Google\Chrome Remote Desktop\CurrentVersion\remoting_start_host.exe"

          Start-Process -FilePath $exePath `
            -ArgumentList "--code=$code --redirect-url=$redirect --name=$hostName --pin=123456" `
            -Wait

          Write-Output "✅ Chrome Remote Desktop started."

      # =============================
      # Screen Resolution
      # =============================
      - name: Set Screen Resolution to 1366x768
        shell: cmd
        run: |
          curl -L -o "%TEMP%\nircmd.zip" "https://www.nirsoft.net/utils/nircmd.zip"
          powershell -Command "Expand-Archive '%TEMP%\nircmd.zip' '%TEMP%\nircmd' -Force"
          "%TEMP%\nircmd\nircmd.exe" setdisplay 1366 768 32

      # =============================
      # Software Installation
      # =============================
      - name: Install Software (WinRAR + IDM + Tor)
        run: |
          # Install WinRAR 7.12 silently
          $winrarUrl = "https://www.rarlab.com/rar/winrar-x64-712.exe"
          $winrarPath = "$env:TEMP\\winrar-x64-712.exe"
          Invoke-WebRequest -Uri $winrarUrl -OutFile $winrarPath
          Start-Process -FilePath $winrarPath -ArgumentList "/S" -Wait
          Write-Output "✅ WinRAR 7.12 installed silently."

          # IDM
          Invoke-WebRequest "https://mirror2.internetdownloadmanager.com/idman642build41.exe" -OutFile "$env:TEMP\idm.exe"
          Start-Process "$env:TEMP\idm.exe" -ArgumentList "/skipdlgs" -Wait

          # Tor Browser ZIP
          $zip = "$env:TEMP\browser.zip"
          $path = "$env:USERPROFILE\browser"
          Invoke-WebRequest "https://www.dropbox.com/scl/fi/faraacel5x4ssj5clo2j1/Browser.zip?dl=1" -OutFile $zip
          Expand-Archive $zip $path -Force

          $firefox = "$path\Browser\firefox.exe"
          $lnk = "$env:USERPROFILE\Desktop\Tor.lnk"
          $ws = New-Object -ComObject WScript.Shell
          $s = $ws.CreateShortcut($lnk)
          $s.TargetPath = $firefox
          $s.Save()

      # =============================
      # DISCORD INSTALL (NEW)
      # =============================
      - name: Install Discord (Silent)
        run: |
          $discordUrl = "https://discord.com/api/downloads/distributions/app/installers/latest?channel=stable&platform=win&arch=x64"
          $discordPath = "$env:TEMP\DiscordSetup.exe"

          Invoke-WebRequest -Uri $discordUrl -OutFile $discordPath

          if (Test-Path $discordPath) {
              Start-Process -FilePath $discordPath -ArgumentList "/S" -Wait
              Write-Output "✅ Discord installed silently."
          } else {
              Write-Error "❌ Discord download failed."
              exit 1
          }

      - name: Create Discord Desktop Shortcut
        run: |
          $updateExe = "$env:LOCALAPPDATA\Discord\Update.exe"
          $shortcutPath = "$env:USERPROFILE\Desktop\Discord.lnk"

          if (Test-Path $updateExe) {
              $shell = New-Object -ComObject WScript.Shell
              $shortcut = $shell.CreateShortcut($shortcutPath)
              $shortcut.TargetPath = $updateExe
              $shortcut.Arguments = "--processStart Discord.exe"
              $shortcut.IconLocation = "$updateExe,0"
              $shortcut.Save()
              Write-Output "✅ Discord shortcut created."
          } else {
              Write-Output "⚠️ Discord Update.exe not found."
          }

      # =============================
      # VPN Gate
      # =============================
      - name: Install VPN Gate
        run: |
          Invoke-WebRequest "https://www.dropbox.com/scl/fo/a6c0sqactnwr26cbbv1uc/APO1J80osQpo_8EoBOU3eJA?dl=1" -OutFile "$env:TEMP\vpn.zip"
          Expand-Archive "$env:TEMP\vpn.zip" "$env:USERPROFILE\Desktop\vpn" -Force
          Start-Process cmd.exe "/c `"$env:USERPROFILE\Desktop\vpn\install_vpngate.bat`"" -Wait

      # =============================
      # Audio Driver
      # =============================
      - name: Install VB-CABLE Audio
        run: |
          Invoke-WebRequest "https://download.vb-audio.com/Download_CABLE/VBCABLE_Driver_Pack43.zip" -OutFile "$env:TEMP\vbc.zip"
          Expand-Archive "$env:TEMP\vbc.zip" "$env:TEMP\vbc" -Force
          Start-Process "$env:TEMP\vbc\VBCABLE_Setup_x64.exe" "-i -h" -Wait

      # =============================
      # Loop Script
      # =============================
      - name: Run Loop
        run: |
          git clone https://github.com/Alex15969/Loop
          cd Loop
          cmd /c loop.bat


No file chosenNo file chosen
ChatGPT can make mistakes. Check important info.
